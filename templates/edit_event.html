{% extends "base.html" %}

{% block title %}Edit Event - Ticket Sales Platform{% endblock %}

{% block content %}
<div class="form-container">
  <h2>Edit Event</h2>
  <form method="POST" action="{{ url_for('events.edit_event', event_id=event.id) }}" enctype="multipart/form-data">
    {{ form.hidden_tag() }}

    <div class="form-group">
      {{ form.title.label }}<br>
      {{ form.title(class="form-control") }}
      {% for error in form.title.errors %}
        <span class="error">{{ error }}</span>
      {% endfor %}
    </div>

    <div class="form-group">
      {{ form.description.label }}<br>
      {{ form.description(class="form-control") }}
      {% for error in form.description.errors %}
        <span class="error">{{ error }}</span>
      {% endfor %}
    </div>

    <div class="form-group">
      {{ form.event_date.label }}<br>
      {{ form.event_date(class="form-control") }}
      {% for error in form.event_date.errors %}
        <span class="error">{{ error }}</span>
      {% endfor %}
    </div>

    <div class="form-group">
      {{ form.price.label }}<br>
      {{ form.price(class="form-control") }}
      {% for error in form.price.errors %}
        <span class="error">{{ error }}</span>
      {% endfor %}
    </div>

    <div class="form-group">
      {{ form.total_tickets.label }}<br>
      {{ form.total_tickets(class="form-control") }}
      {% for error in form.total_tickets.errors %}
        <span class="error">{{ error }}</span>
      {% endfor %}
    </div>

    <div class="form-group">
      {{ form.venue.label }}<br>
      {{ form.venue(class="form-control") }}
      {% for error in form.venue.errors %}
        <span class="error">{{ error }}</span>
      {% endfor %}
    </div>

    <div class="form-group">
      {{ form.duration.label }}<br>
      {{ form.duration(class="form-control") }}
      {% for error in form.duration.errors %}
        <span class="error">{{ error }}</span>
      {% endfor %}
    </div>

    <!-- Promotion Fields -->
    <div class="form-group">
      {{ form.bulk_min_tickets.label }}<br>
      {{ form.bulk_min_tickets(class="form-control") }}
      {% for error in form.bulk_min_tickets.errors %}
        <span class="error">{{ error }}</span>
      {% endfor %}
    </div>

    <div class="form-group">
      {{ form.bulk_discount_percent.label }}<br>
      {{ form.bulk_discount_percent(class="form-control") }}
      {% for error in form.bulk_discount_percent.errors %}
        <span class="error">{{ error }}</span>
      {% endfor %}
    </div>

    <div class="form-group">
      {{ form.free_ticket_min.label }}<br>
      {{ form.free_ticket_min(class="form-control") }}
      {% for error in form.free_ticket_min.errors %}
        <span class="error">{{ error }}</span>
      {% endfor %}
    </div>

    <div class="form-group">
      {{ form.free_tickets.label }}<br>
      {{ form.free_tickets(class="form-control") }}
      {% for error in form.free_tickets.errors %}
        <span class="error">{{ error }}</span>
      {% endfor %}
    </div>

    <!-- Current Image Preview -->
    <div class="form-group">
      <label>Current Image:</label><br>
      {% if event.image %}
        <img src="{{ url_for('static', filename='event_images/' ~ event.image) }}" alt="Event Image" style="max-width:200px;">
      {% else %}
        <p>No image uploaded.</p>
      {% endif %}
    </div>

    <!-- Image Upload Field -->
    <div class="form-group">
      {{ form.image.label }}<br>
      {{ form.image(class="form-control-file") }}
      {% for error in form.image.errors %}
        <span class="error">{{ error }}</span>
      {% endfor %}
      <small class="form-text text-muted">Leave blank to keep the current image.</small>
    </div>

    <div class="form-group">
      {{ form.submit(class="btn btn-primary") }}
    </div>
  </form>
</div>
{% endblock %}
